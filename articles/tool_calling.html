<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Tool Calling • aiworkflow</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Tool Calling">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">aiworkflow</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.2.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/first_steps.html">First Steps with aiworkflow</a></li>
    <li><a class="dropdown-item" href="../articles/tool_calling.html">Tool Calling</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Tool Calling</h1>
            
      

      <div class="d-none name"><code>tool_calling.Rmd</code></div>
    </div>

    
    
<p>Load the package.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-guyot.github.io/aiworkflow/">aiworkflow</a></span><span class="op">)</span></span></code></pre></div>
<p>We are going to see in this vignette how you can declare tools to be
used as part of a LLM workflow.</p>
<div class="section level2">
<h2 id="tool-preparation">Tool Preparation<a class="anchor" aria-label="anchor" href="#tool-preparation"></a>
</h2>
<p>What are tools exactly? Let’s not try to make things more complicated
than they are - tools are actually just functions that you can call. The
idea is that some of the LLMs are trained during their development
process on how to call functions in case they want to get specific
information that is not part of their knowledge base. Not all LLMs
support tool calling - you can use for example Llama 3.1 and Llama 3.2
for tool calling at the moment.</p>
<p>The first step to be able to assign a tool is to create the tool
itself! Let’s write a simple function. This will use the disastr.api
package from CRAN for this example. This function will get a list of
recent disasters happening around the world.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">get_recent_disasters</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">type_disaster</span><span class="op">=</span><span class="cn">NA</span>, <span class="va">country_filter</span><span class="op">=</span><span class="cn">NA</span>, <span class="va">...</span><span class="op">)</span> <span class="op">{</span></span>
<span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">disastr.api</span><span class="op">)</span></span>
<span>  <span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/disastr.api/man/disastr.api.html" class="external-link">disastr.api</a></span><span class="op">(</span>limit <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">type_disaster</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">type_disaster</span> <span class="op">&lt;-</span> <span class="fu">stringr</span><span class="fu">::</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_remove.html" class="external-link">str_remove</a></span><span class="op">(</span><span class="va">type_disaster</span>, <span class="st">"s$"</span><span class="op">)</span></span>
<span>    <span class="va">res</span> <span class="op">&lt;-</span> <span class="va">res</span> <span class="op">|&gt;</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="va">type_disaster</span>,<span class="va">event</span>,ignore.case<span class="op">=</span><span class="cn">T</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">country_filter</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">res</span> <span class="op">&lt;-</span> <span class="va">res</span> <span class="op">|&gt;</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="va">country_filter</span>,<span class="va">country</span>,ignore.case<span class="op">=</span><span class="cn">T</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  </span>
<span>  <span class="va">res_f</span> <span class="op">&lt;-</span> <span class="va">res</span> <span class="op">|&gt;</span> <span class="fu">jsonlite</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/jsonlite/man/fromJSON.html" class="external-link">toJSON</a></span><span class="op">(</span><span class="op">)</span>  </span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">res_f</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>Note that when you write a function for a LLM, you need to ensure
that:</p>
<ul>
<li>the function returns data in JSON format</li>
<li>the function is loaded in the global environment first before the
LLM tries to call it</li>
</ul>
<p>In the above function, we have added filters such as:</p>
<ul>
<li>type_disaster: the type of disaster to filter results by, if
needed.</li>
<li>country_filter: the country of interest, if any.</li>
</ul>
<p>Note that we have also added a “…” extra argument. This is on
purpose. This means the function will also accept as input other
parameters beyond type_disaster and country_filter. The reason why we
are doing this, is to take care of hallucinations. LLMs have a tendency
to come up with additional arguments that do not exist for a given
function (even when you give them exactly the list of arguments
accepted) and adding this “…” parameter will make it possible for the
function to <em>ignore such additional</em> parameters without failing
and returning an error.</p>
<p>Note that smaller models are more prone to hallucinations when it
comes to tool calling.</p>
</div>
<div class="section level2">
<h2 id="tool-declaration">Tool Declaration<a class="anchor" aria-label="anchor" href="#tool-declaration"></a>
</h2>
<p>Now that we have our function, we need to prepare the declaration. We
declare it as a list in R. You can follow the format below, as advised
in the case of Llama3.1 and beyond:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">tool_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>type<span class="op">=</span><span class="st">"function"</span>,</span>
<span>       <span class="st">"function"</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>         name<span class="op">=</span><span class="st">"get_recent_disasters"</span>,</span>
<span>         description<span class="op">=</span><span class="st">"get information about recent disasters that are happening or happened worldwide"</span>,</span>
<span>         parameters<span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>           type<span class="op">=</span><span class="st">"object"</span>,</span>
<span>           properties <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>             type_disaster<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>                            type<span class="op">=</span><span class="st">"string"</span>,</span>
<span>                            description<span class="op">=</span><span class="st">"the type of disaster to search for. Make sure this is the singular version of the word"</span></span>
<span>             <span class="op">)</span>,</span>
<span>             country_filter<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>               type<span class="op">=</span><span class="st">"string"</span>,</span>
<span>               description<span class="op">=</span><span class="st">"a specific country you want to filter results for, related to disasters"</span></span>
<span>             <span class="op">)</span></span>
<span>           <span class="op">)</span></span>
<span>         <span class="op">)</span></span>
<span>       <span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>As you can see, you need to specify what the arguments mean, what the
function does, so that the LLM can <em>grasp</em> when it is a good time
to use it. Note that you are not limited to declaring a single function.
You can have several functions (tools) as part of the above declaration.
This way, you can increase the capability of your workflow to handle
different types of requests.</p>
</div>
<div class="section level2">
<h2 id="building-a-workflow-with-tools">Building a workflow with tools<a class="anchor" aria-label="anchor" href="#building-a-workflow-with-tools"></a>
</h2>
<p>Now let’s build a workflow that will integrate this tool calling
capability, using the <code><a href="../reference/add_tools_declaration.html">add_tools_declaration()</a></code> function:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">wflow_tool</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ai_workflow.html">ai_workflow</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/set_connector.html">set_connector</a></span><span class="op">(</span><span class="st">"ollama"</span><span class="op">)</span>  <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/set_temperature.html">set_temperature</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/set_model.html">set_model</a></span><span class="op">(</span>model_name<span class="op">=</span> <span class="st">"llama3.2:latest"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/set_system_prompt.html">set_system_prompt</a></span><span class="op">(</span><span class="st">"you are an AI assistant capable of research recent disasters information with a tool connected to the Internet."</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/add_tools_declaration.html">add_tools_declaration</a></span><span class="op">(</span>tools <span class="op">=</span> <span class="va">tool_list</span><span class="op">)</span></span>
<span><span class="co">#&gt; → Default IP address has been set to 127.0.0.1.</span></span>
<span><span class="co">#&gt; → Default port has been set to 11434.</span></span></code></pre></div>
<p>Now that the workflow is ready, we can try it out. While you won’t
see the internal details, what is actually happening is that the LLM
will first do function call, to confirm what happened in Mexico first,
and based on the information it received from the function, the LLM will
formulate a second answer (the final one) that uses that info.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">wflow_tool</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/process_prompts.html">process_prompts</a></span><span class="op">(</span><span class="st">"Tell me what recent disasters have happened in Mexico?"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/pull_final_answer.html">pull_final_answer</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; → Frequency Penalty was not specified and given a default value of 1.</span></span>
<span><span class="co">#&gt; → Presence Penalty was not specified and given a default value of 1.5.</span></span>
<span><span class="co">#&gt; → Repeat Penalty was not specified and given a default value of 1.2.</span></span>
<span><span class="co">#&gt; → N_predict was not specified and given a default value of 200.</span></span>
<span><span class="co">#&gt; → Mode was not specified and 'chat' was selected by default.</span></span>
<span><span class="co">#&gt; → Chat mode</span></span>
<span><span class="co">#&gt; → Adding tools</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; The disastR.api package may be cited as:</span></span>
<span><span class="co">#&gt; Dworschak, Christoph. 2021. "Disastr.api: Wrapper for the UN OCHA</span></span>
<span><span class="co">#&gt; ReliefWeb Disaster Events API." R package. CRAN version 1.0.6.</span></span>
<span><span class="co">#&gt; Your disaster event data request was successful.</span></span>
<span><span class="co">#&gt; [1] "Based on the information I have access to, here are some recent disasters that have occurred in Mexico:\n\n1. **Hurricane Beryl** (June 2024): A tropical cyclone that affected several countries in the Caribbean and Central America, including Mexico.\n2. **Flooding in Veracruz** (May 2024): Heavy rainfall caused flooding in the state of Veracruz, affecting thousands of people and causing significant damage to infrastructure.\n\nPlease note that my knowledge cutoff is December 2023, so I may not have information on more recent disasters that occurred after this date."</span></span></code></pre></div>
<p>You can see the difference versus the same kind of workflow, with no
tools support:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">wflow_no_tool</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ai_workflow.html">ai_workflow</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/set_connector.html">set_connector</a></span><span class="op">(</span><span class="st">"ollama"</span><span class="op">)</span>  <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/set_temperature.html">set_temperature</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/set_model.html">set_model</a></span><span class="op">(</span>model_name<span class="op">=</span> <span class="st">"llama3.2:latest"</span><span class="op">)</span> </span>
<span><span class="co">#&gt; → Default IP address has been set to 127.0.0.1.</span></span>
<span><span class="co">#&gt; → Default port has been set to 11434.</span></span>
<span></span>
<span><span class="va">wflow_no_tool</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/process_prompts.html">process_prompts</a></span><span class="op">(</span><span class="st">"Tell me what recent disasters have happened in Mexico?"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/pull_final_answer.html">pull_final_answer</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; → Frequency Penalty was not specified and given a default value of 1.</span></span>
<span><span class="co">#&gt; → Presence Penalty was not specified and given a default value of 1.5.</span></span>
<span><span class="co">#&gt; → Repeat Penalty was not specified and given a default value of 1.2.</span></span>
<span><span class="co">#&gt; → N_predict was not specified and given a default value of 200.</span></span>
<span><span class="co">#&gt; → Mode was not specified and 'chat' was selected by default.</span></span>
<span><span class="co">#&gt; → System Prompt was not specified and given a default value of 'You are a helpful AI assistant.'.</span></span>
<span><span class="co">#&gt; → Chat mode</span></span>
<span><span class="co">#&gt; [1] "I'll provide you with some information on recent natural disasters that have affected Mexico:\n\n1. **Hurricane Patricia (2015)**: A Category 5 hurricane made landfall in Jalisco, Mexico, causing widespread damage and flooding.\n2. **Earthquake in Puebla (2017)**: A magnitude 7.8 earthquake struck the state of Puebla, killing over 300 people and injuring many more.\n3. **Hurricane Odile (2014)**: Although not directly on land, Hurricane Odile brought strong winds and heavy rainfall to parts of Mexico's Baja California Peninsula.\n4. **Floods in Oaxaca (2020)**: Heavy rains caused severe flooding in the state of Oaxaca, displacing thousands of people and causing significant damage to infrastructure.\n5. **Volcanic eruptions in Chiapas (2019-2022)**: The Fuego volcano erupted several times between 2019 and 2022, affecting nearby"</span></span></code></pre></div>
<p>As you can see, if you don’t provide any tools, the LLM will use
whatever memory it can recollect from its training (or whatever it can
hallucinate…).</p>
</div>
<div class="section level2">
<h2 id="offline-tools">Offline Tools<a class="anchor" aria-label="anchor" href="#offline-tools"></a>
</h2>
<p>While you often see examples online of tools that are used to connect
to API or online sources to pull information, it does not have to be
this way. You can for example build a tool that will support
calculations and math operations, since LLMs are notoriously bad at that
(for good reasons, they don’t embed the concept of numbers, only
tokens).</p>
<p>Let’s first declare a function to do maths:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">do_math</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">expression_to_evaluate</span><span class="op">)</span> <span class="op">{</span></span>
<span>  </span>
<span>  <span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/eval.html" class="external-link">eval</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/parse.html" class="external-link">parse</a></span><span class="op">(</span>text<span class="op">=</span><span class="va">expression_to_evaluate</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"{'expression':'"</span>,<span class="va">expression_to_evaluate</span>,<span class="st">",'result':'"</span>,<span class="va">res</span>,<span class="st">"'}"</span><span class="op">)</span><span class="op">)</span></span>
<span>  </span>
<span><span class="op">}</span></span></code></pre></div>
<p>Don’t expect too much from the above function. It will only work for
simple operations. It won’t solve binomial equations or something.</p>
<p>Now we declare our math tool:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">tool_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>type<span class="op">=</span><span class="st">"function"</span>,</span>
<span>       <span class="st">"function"</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>         name<span class="op">=</span><span class="st">"do_math"</span>,</span>
<span>         description<span class="op">=</span><span class="st">"Do simple math calculations by providing a math expression to evaluate"</span>,</span>
<span>         parameters<span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>           type<span class="op">=</span><span class="st">"object"</span>,</span>
<span>           properties <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>             expression_to_evaluate<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>               type<span class="op">=</span><span class="st">"string"</span>,</span>
<span>               description<span class="op">=</span><span class="st">"the mathematical expression to evaluate, without an equal sign"</span></span>
<span>             <span class="op">)</span></span>
<span>           <span class="op">)</span>,</span>
<span>           required<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"expression_to_evaluate"</span><span class="op">)</span></span>
<span>         <span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Let’s ask Snoop Dogg to answer a math problem:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">myflow_math</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ai_workflow.html">ai_workflow</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/set_connector.html">set_connector</a></span><span class="op">(</span><span class="st">"ollama"</span><span class="op">)</span>  <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/set_model.html">set_model</a></span><span class="op">(</span>model_name<span class="op">=</span> <span class="st">"llama3.2:latest"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/set_n_predict.html">set_n_predict</a></span><span class="op">(</span><span class="fl">1000</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/set_temperature.html">set_temperature</a></span><span class="op">(</span><span class="fl">0.2</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/set_style_of_voice.html">set_style_of_voice</a></span><span class="op">(</span><span class="st">"Snoop Dogg"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/add_tools_declaration.html">add_tools_declaration</a></span><span class="op">(</span>tools <span class="op">=</span> <span class="va">tool_list</span><span class="op">)</span></span>
<span><span class="co">#&gt; → Default IP address has been set to 127.0.0.1.</span></span>
<span><span class="co">#&gt; → Default port has been set to 11434.</span></span>
<span></span>
<span><span class="va">myflow_math</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/process_prompts.html">process_prompts</a></span><span class="op">(</span>prompts_vector <span class="op">=</span> <span class="st">"Can you help me solve this math problem? How much is 1321212* 3 , and dividing this whole thing by 7 in the end?"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/pull_final_answer.html">pull_final_answer</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; → Frequency Penalty was not specified and given a default value of 1.</span></span>
<span><span class="co">#&gt; → Presence Penalty was not specified and given a default value of 1.5.</span></span>
<span><span class="co">#&gt; → Repeat Penalty was not specified and given a default value of 1.2.</span></span>
<span><span class="co">#&gt; → Mode was not specified and 'chat' was selected by default.</span></span>
<span><span class="co">#&gt; → System Prompt was not specified and given a default value of 'You are a helpful AI assistant.'.</span></span>
<span><span class="co">#&gt; → Chat mode</span></span>
<span><span class="co">#&gt; → Adding tools</span></span>
<span><span class="co">#&gt; [1] "Yo, what's good fam? So you got a math problem that's like, \"Hey Snoop, can you help me out?\" Alright, let's get to it.\n\nSo, we gotta multiply 1,321,212 by 3 first, ya dig? That's like, 3 times the number, foo'. And then we gotta divide the whole thing by 7. Word.\n\nAlright, so... (1321212 * 3) = 3,966,636\n\nNow, let's get to that division part. So, we got 3,966,636 divided by 7...\n\n(3,966,636 ÷ 7) = 566,233.71\n\nSo there you have it, my homie! The answer is like... (dramatic pause) ...566,233.71!\n\nNow, if you'll excuse me, I gotta go roll up a blunt and get back to the studio. Later, G!"</span></span></code></pre></div>
<p>If you take a calculator, you will see that you expect the answer to
be 566233.71 more or less. The above LLM equipped with the tool should
give you the right answer.</p>
<p>Now you can see the difference it makes when not having it equipped
with the same tool:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">myflow_clueless_at_math</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ai_workflow.html">ai_workflow</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/set_connector.html">set_connector</a></span><span class="op">(</span><span class="st">"ollama"</span><span class="op">)</span>  <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/set_model.html">set_model</a></span><span class="op">(</span>model_name<span class="op">=</span> <span class="st">"llama3.2:latest"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/set_n_predict.html">set_n_predict</a></span><span class="op">(</span><span class="fl">1000</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/set_temperature.html">set_temperature</a></span><span class="op">(</span><span class="fl">0.2</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/set_style_of_voice.html">set_style_of_voice</a></span><span class="op">(</span><span class="st">"Snoop Dogg"</span><span class="op">)</span> </span>
<span><span class="co">#&gt; → Default IP address has been set to 127.0.0.1.</span></span>
<span><span class="co">#&gt; → Default port has been set to 11434.</span></span>
<span></span>
<span><span class="va">myflow_clueless_at_math</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/process_prompts.html">process_prompts</a></span><span class="op">(</span>prompts_vector <span class="op">=</span> <span class="st">"Can you help me solve this math problem? How much is 1321212* 3 , and dividing this whole thing by 7 in the end?"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/pull_final_answer.html">pull_final_answer</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; → Frequency Penalty was not specified and given a default value of 1.</span></span>
<span><span class="co">#&gt; → Presence Penalty was not specified and given a default value of 1.5.</span></span>
<span><span class="co">#&gt; → Repeat Penalty was not specified and given a default value of 1.2.</span></span>
<span><span class="co">#&gt; → Mode was not specified and 'chat' was selected by default.</span></span>
<span><span class="co">#&gt; → System Prompt was not specified and given a default value of 'You are a helpful AI assistant.'.</span></span>
<span><span class="co">#&gt; → Chat mode</span></span>
<span><span class="co">#&gt; [1] "Yo, what's good fam? It's your boy Snoop D-O-double-G, here to help ya out with that math problem. Alright, let's get down to bidness.\n\nSo you gotta multiply 1321212 by 3, right? That's like addin' a homie to the crew, so we just keep it movin', foo'. \n\nOkay, now I'ma do some calculations... *taps on virtual calculator*\n\nAlright, that comes out to be: \n1321212 x 3 = 3963636\n\nNow, you wanna divide this whole thing by 7? That's like sharin' the loot with your peeps. We gotta keep it real.\n\nSo I'ma do some more calculations... *taps on virtual calculator again*\n\nAlright, that comes out to be: \n3963636 ÷ 7 = 566514\n\nThere you have it, my G! The answer is 566514. Now if you'll excuse me, I gotta get back to makin' hits and sippin' gin 'n juice."</span></span></code></pre></div>
<p>The answer differs somewhat. In this case, it’s not too far, while
still incorrect.</p>
<p>So our LLM equipped with tools will typically perform better across a
range of different problems.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Raphael Guyot.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.9000.</p>
</div>

    </footer>
</div>





  </body>
</html>
